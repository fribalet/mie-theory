                                    Ricatti-Bessel functions                                    RB1 and RB2 are functions used to                                    calculate the Ricatti-Bessel                                    functions of the first and second                                    kinds respectively. These functions                                    are provide the radial component of                                    the scattering coefficients.                                    RB1(r, nmax) calculates the                                    Ricatti-Bessel function of the first                                    kind from order 1 to nmax, for radius   [Ricatti-Bessel functions]       parameter(s) r, by downwards                                    recursion. The returns are nmax-by-nr                                    matrices, where nr is the dimension                                    of the vector r, each column                                    representing the results for one                                    radius.                                    RB2(r, nmax) similarly calculates the                                    Ricatti-Bessel function by upwards                                    recursion.                                                       [Return to Index]   RB1.m   % RB1   the Ricatti-Bessel function of the first kind   %       RB1(rho, nmax) for the value rho from n=1 to n=nmax.   % Written by and copyright   %       Dave Barnett   %       Optical Engineering Group   %       Dept. of Electrical and Electronic Engineering   %       Loughborough University   %               20th November 1996   %       Modified 13th December 1998   %               Generalised to receive vectors of rho and return matrices.   function phi = RB1(rho, nmax)   rho=rho(:).';   nst = ceil(nmax + sqrt(101+max(rho)));   phi= zeros(nst,length(rho));   phi(nst-1,:) = 1e-10;   for n=nst-2:-1:1           phi(n,:) = (2*n+3)*phi(n+1,:)./rho - phi(n+2,:);   end   phi0 = 3*phi(1,:)./rho - phi(2,:);   phi0 = sin(rho)./phi0;   phi = phi(1:nmax,:) .* (ones(nmax,1)*phi0);   RB2.m   % RB2   the Ricatti-Bessel function of the second kind   %       RB2(rho, nmax) for the value rho from n=1 to n=nmax.   % Written by and copyright   %       Dave Barnett   %       Optical Engineering Group   %       Dept. of Electrical and Electronic Engineering   %       Loughborough University   %       20th November 1996   %       Modified 13th December 1998   %               Generalised to receive vectors of rho and return matrices.   %       Modified 8th January 1999   %               Zeta matrix allocated at start of function.   function zeta = RB2(rho, nmax)   rho = rho(:).';   zeta = zeros(nmax,length(rho));   zeta(1,:) = -cos(rho)./rho - sin(rho);   zeta(2,:) = 3*zeta(1,:)./rho + cos(rho);   for n=3:nmax           zeta(n,:) = (2*n-1)*zeta(n-1,:)./rho - zeta(n-2,:);   endThis page designed by the author of the m-files, David Barnett